// main script name
manifest {
    name = 'oalmelid/baal-nf'
    author = 'Ã˜yvind Almelid'
    homePage = 'https://git.ecdf.ed.ac.uk/oalmelid/baal-nf'
    description = 'ChIP seq ASB detection pipeline'
    mainScript = 'baal-pipeline.nf'
    nextflowVersion = '>=20.07.1'
    version = '1.0.0'
}

profiles {
    dev {
        includeConfig 'conf/local.config'
    }

    eddie {
        includeConfig 'conf/eddie.config'
    }

    conda {
        includeConfig 'conf/conda.config'
    }

    singularity {
        includeConfig 'conf/singularity.config'
    }
    
    docker {
        includeConfig 'conf/docker.config'
    }

    test {
        includeConfig 'conf/test.config'
    }
}

process {
    cpus=1
    ext.baseMemory = 8.GB
    memory = { task.ext.baseMemory * task.attempt }

    withLabel: bigmem {
        memory = { task.ext.baseMemory * task.attempt * 2 }
    }

    errorStrategy = { task.exitStatus in 137..140 ? 'retry' : 'terminate' }
    maxRetries = 3 
}
